@model PsikologProje_Void.ViewModels.AppointmentViewModel

<div class="appointment-card h-100 d-flex flex-column">
    <div class="d-flex align-items-center mb-3">
        <img src="@(string.IsNullOrEmpty(Model.DoctorProfilePhotoPath) ? "/images/default-avatar.png" : Model.DoctorProfilePhotoPath)" alt="@Model.DoctorName" class="doctor-photo">
        <div class="ms-3">
            <h5 class="card-title mb-0">@Model.DoctorName</h5>
            <div class="doctor-rating">
                <i class="fas fa-star text-warning"></i>
                <span>@Model.DoctorAverageRating.ToString("0.0")</span>
            </div>
        </div>
    </div>

    <p class="card-subtitle mb-2 text-white-50">@string.Join(", ", Model.Specialties)</p>
    <hr style="border-color: rgba(255, 255, 255, 0.1);" />

    <div class="card-info-grid">
        <div><i class="fas fa-calendar-alt fa-fw me-2"></i>@Model.StartTime.ToString("dd MMMM, dddd")</div>
        <div><i class="fas fa-clock fa-fw me-2"></i>@Model.StartTime.ToString("HH:mm") - @Model.EndTime.ToString("HH:mm") (@Model.DurationInMinutes dk)</div>
        <div><i class="fas fa-tags fa-fw me-2"></i>@Model.PriceRange</div>
        @if (Model.DistanceKm.HasValue)
        {
            <div><i class="fas fa-route fa-fw me-2"></i>Yaklaşık @Model.DistanceKm.Value.ToString("0.0") km</div>
        }
    </div>

    <div class="my-3">
        @foreach (var type in Model.AppointmentTypes)
        {
            <span class="badge bg-info me-1">@type</span>
        }
    </div>

    <div class="mt-auto text-end">
        @if (Model.Location != null)
        {
            <button class="btn btn-outline-light btn-sm location-btn"
                    data-bs-toggle="modal"
                    data-bs-target="#locationModal"
                    data-lat="@Model.Location.Y.ToString(System.Globalization.CultureInfo.InvariantCulture)"
                    data-lon="@Model.Location.X.ToString(System.Globalization.CultureInfo.InvariantCulture)"
                    data-doctor="@Model.DoctorName">
                <i class="fas fa-map-marker-alt"></i> Konum
            </button>
        }

        @if (Model.IsRequestedByCurrentUser)
        {
            <button class="btn btn-secondary" disabled><i class="fas fa-check"></i> Talep Edildi</button>
        }
        else
        {
            <button class="btn btn-outline-success request-btn"
                    data-bs-toggle="modal" data-bs-target="#requestModal"
                    data-appointment-id="@Model.Id" data-doctor-id="@Model.DoctorId">
                <i class="fas fa-paper-plane"></i> Talep Et
            </button>
        }
    </div>
</div>